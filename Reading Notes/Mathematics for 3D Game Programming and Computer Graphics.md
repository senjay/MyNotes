# 3D游戏与计算机图形学中的数学方法

[TOC]

## 第一章 渲染管线

### 1.1 图形处理器

CPU-GPU通信：

​		内存<---->CPU---->应用程序---->渲染库(如OpenGL)---->图形卡驱动---->GPU<---->显存

显存主要缓冲区：

1. 前后图像缓冲区切换,前：用户可见；后：用户不可见。切换要与屏幕刷新率同步，否则会画面撕裂，即不同时刻的画面出现在屏幕上，屏幕不同部分的画面来自不同缓冲区。
2. 深度缓冲区（z-缓冲区）：每个像素在图像中的深度值，即该像素里虚拟相机距离。因此可用于隐藏面剔除（只允许显示深度值小于图像缓冲区中像素的深度值的像素）。

###  1.2 顶点变换

​		为了将三维数据变换为二维的图像显示在屏幕上(这是目的，真正进行这步操作的是光栅化)，在模型坐标在世界坐标中映射入相机视界，再通过投影变换来实现近大远小，通过齐次裁剪保证只渲染视界以内元素。注意，顶点也是携带纹理坐标的，这样可以通过纹理映射找到颜色值。

​		个人理解为坐标变换。

### 1.3 光栅化和段操作

​		将几何元素经过变换填充至屏幕的过程称为光栅化。

​		光栅化后，GPU计算出每个像素的深度、各顶点插值的颜色、差值得出的纹理坐标与像素自己的位置合称为段数据。段数据经过段操作处理后便可写入图像缓冲区，以下是操作的过程

```flow
st=>start: 段数据
op2=>operation: 像素包含测试
op3=>operation: 裁剪测试
op4=>operation: Alpha测试
op5=>operation: 模板测试
op6=>operation: 深度测试
op7=>operation: 混合
ed=>end: 图像缓冲区

st(right)->op2(right)->op3(right)->op4(right)->op5(right)->op6(right)->op7(right)->ed
```

### 1.4  总结

​		这章主要介绍了3维物体在2维屏幕上展现的基本过程，主要是概念上的介绍。

```flow
st=>start: 三维数据
op1=>operation: 坐标变换
op2=>operation: 颜色计算
op3=>operation: 光栅化
ed=>end: 二维屏幕

st(right)->op1(right)->op2(right)->op3(right)->ed
```

## 第二章 向量

​		列向量$P$在$Q$上的投影$proj_QP$通过矩阵可表示为:

$$
\begin{align}
	proj_QP
	&=\frac{Q^TP}{||Q||}\\
    &=Q\frac{Q^TP}{||Q||^2}\\
	&=\frac{QQ^T}{Q^TQ}P\\
\end{align}
$$
,其中$\frac{QQ^T}{Q^TQ}$为投影矩阵。	

## 第三章 矩阵



